<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/assets/iziToast/iziToast-1.4.0.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
          integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/login.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Alkatra:wght@400;600;700&famicxly=Fira+Sans:ital,wght@0,200;0,300;1,200&family=Geologica:wght@100;200;400&family=Merriweather:ital,wght@0,300;0,400;1,300;1,400&family=Raleway:ital,wght@0,300;0,500;1,200;1,300;1,400&family=Roboto+Slab:wght@700;800&display=swap');
    </style>
</head>
<body>
<div class="container" id="container">
    <div class="form-container sign-in-container">
        <form  method="POST">
            <h1>Sign in</h1>
            <div class="social-container">
            </div>
            <span>Use your account</span>
            <input type="text" id="usernameLog" name="user_email" placeholder="User Name" value="user@gmail.com" required>
            <input type="password" id="passwordLog" name="user_pass" placeholder="Password" value="123123" required>
            <a href="#">Forgot your password?</a>
            <button id="btnLogin" name="btn_submit" type="button">Sign In</button>
        </form>
    </div>
    <div class="overlay-container">
        <div class="overlay">
            <div class="overlay-panel overlay-left">
                <h1>Welcome Back!</h1>
                <p>To keep connected with us please login with your personal info</p>
                <button class="ghost" id="signIn">Sign In</button>
            </div>
            <div class="overlay-panel overlay-right">
                <h1>Hello, Friend!</h1>
                <p>Enter your personal details and start journey with us</p>
                <a href="/register">
                    <button class="ghost" id="showSignUp">Sign Up</button>
                </a>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/iziToast/iziToast-1.4.0.js"></script>
<script src="/assets/js/app.js"></script>

<script>

    const signIn = $('#signIn');
    const usernameLog = $('#usernameLog');
    const passwordLog = $('#passwordLog');
    const btnLogin = $('#btnLogin');

    const role = $('#role');
    const usernameReg = $('#usernameReg');
    const passwordReg = $('#passwordReg');
    const rePasswordReg = $('#rePasswordReg');
    const btnRegister = $('#btnRegister');

    btnLogin.on('click', () => {
        const obj = {
            username: usernameLog.val(),
            password: passwordLog.val()
        }

        $.ajax({
            headers: {
                'accept': 'application/json',
                'content-type': 'application/json'
            },
            type: 'POST',
            url: 'http://localhost:9001/api/auth/login',
            data: JSON.stringify(obj)
        })
            .done((data) => {
                App.IziToast.showSuccessAlert("Đăng nhập thành công");
                if(data.roles[0].authority === "ADMIN"){
                    location.href = "/dashboards";
                }
                else {
                    location.href = "/shop";
                }

            })
            .fail((jqXHR) => {
                console.log(jqXHR);
                App.IziToast.showErrorAlert('Đăng nhập thất bại');
            })
    })

</script>
</body>

</html>